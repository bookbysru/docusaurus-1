<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Deployment: View · Open Power Quality</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Deployment: View · Open Power Quality"/><meta property="og:type" content="website"/><meta property="og:url" content="https://openpowerquality.org/index.html"/><meta property="og:description" content="OPQView is a [Meteor](http://meteor.com) application.  For general information on deploying Meteor applications, see the [Meteor Guide chapter on deployment](https://guide.meteor.com/deployment.html) and the [meteor build command documentation](https://docs.meteor.com/commandline.html#meteorbuild)."/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/opq.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://openpowerquality.org/blog/atom.xml" title="Open Power Quality Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://openpowerquality.org/blog/feed.xml" title="Open Power Quality Blog RSS Feed"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Gugi"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type="text/javascript" src="/js/mathjax-config.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible doc separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/opqlogo_white.png" alt="Open Power Quality"/><h2 class="headerTitleWithLogo">Open Power Quality</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/intro-motivation.html" target="_self">Documentation</a></li><li class="siteNavGroupActive"><a href="/docs/other-opportunities.html" target="_self">Opportunities</a></li><li class=""><a href="/blog" target="_self">News</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Deployment</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>Introduction</h3><ul><li class="navListItem"><a class="navItem" href="/docs/intro-motivation.html">Motivation for OPQ</a></li><li class="navListItem"><a class="navItem" href="/docs/intro-power-quality.html">A beginner&#x27;s guide to power quality</a></li><li class="navListItem"><a class="navItem" href="/docs/intro-system-architecture.html">OPQ System Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/intro-information-architecture.html">OPQ Information Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/intro-related-work.html">Related Work</a></li><li class="navListItem"><a class="navItem" href="/docs/intro-bibliography.html">Bibliography</a></li></ul></div><div class="navGroup navGroupActive"><h3>User Guide</h3><ul><li class="navListItem"><a class="navItem" href="/docs/userguide-hardware.html">OPQ Box</a></li><li class="navListItem"><a class="navItem" href="/docs/userguide-software.html">OPQ Cloud</a></li></ul></div><div class="navGroup navGroupActive"><h3>OPQ Box</h3><ul><li class="navListItem"><a class="navItem" href="/docs/box-overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/box-hardware-design.html">Hardware Design</a></li><li class="navListItem"><a class="navItem" href="/docs/box-software-design.html">Software Design</a></li><li class="navListItem"><a class="navItem" href="/docs/box-updater.html">Updater</a></li><li class="navListItem"><a class="navItem" href="/docs/box-manufacturing.html">Manufacturing</a></li></ul></div><div class="navGroup navGroupActive"><h3>OPQ Cloud</h3><ul><li class="navListItem"><a class="navItem" href="/docs/cloud-overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-datamodel.html">Data Model</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-view.html">View</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-mauka.html">Mauka</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-makai.html">Makai</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-health.html">Health</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-protocol.html">Protocol</a></li><li class="navListItem"><a class="navItem" href="/docs/cloud-port-map.html">Port Map</a></li></ul></div><div class="navGroup navGroupActive"><h3>Misc Development</h3><ul><li class="navListItem"><a class="navItem" href="/docs/developerguide-docusaurus.html">Documentation</a></li><li class="navListItem"><a class="navItem" href="/docs/developerguide-virtual-machine.html">VM &amp; Sim</a></li><li class="navListItem"><a class="navItem" href="/docs/developerguide-bibliography.html">Bibliography</a></li></ul></div><div class="navGroup navGroupActive"><h3>Deployment</h3><ul><li class="navListItem"><a class="navItem" href="/docs/deploy-initial-configuration.html">Initial Configuration</a></li><li class="navListItem"><a class="navItem" href="/docs/deploy-mongodb.html">MongoDB</a></li><li class="navListItem"><a class="navItem" href="/docs/deploy-mauka.html">Mauka</a></li><li class="navListItem"><a class="navItem" href="/docs/deploy-makai.html">Makai</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/deploy-view.html">View</a></li><li class="navListItem"><a class="navItem" href="/docs/deploy-health.html">Health</a></li><li class="navListItem"><a class="navItem" href="/docs/deploy-docker.html">Docker</a></li></ul></div><div class="navGroup navGroupActive"><h3>Other</h3><ul><li class="navListItem"><a class="navItem" href="/docs/other-roadmap.html">Roadmap</a></li><li class="navListItem"><a class="navItem" href="/docs/other-opportunities.html">R&amp;D Opportunities</a></li><li class="navListItem"><a class="navItem" href="/docs/other-agile-power-monitoring.html">Agile Power Monitoring for UH</a></li><li class="navListItem"><a class="navItem" href="/docs/other-g1-pilot-study.html">G1 Pilot Study (2014)</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>Deployment: View</h1></header><article><div><span><p>OPQView is a <a href="http://meteor.com">Meteor</a> application.  For general information on deploying Meteor applications, see the <a href="https://guide.meteor.com/deployment.html">Meteor Guide chapter on deployment</a> and the <a href="https://docs.meteor.com/commandline.html#meteorbuild">meteor build command documentation</a>.</p>
<p>There are basically two steps to deploying OPQView: building the production bundle (a nodejs application) on a development machine, then running the bundle on the server.</p>
<h2><a class="anchor" aria-hidden="true" id="developer-system-deployment-tasks"></a><a href="#developer-system-deployment-tasks" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Developer system deployment tasks</h2>
<p>First, make sure you have <a href="deploy-initial-configuration.html#set-up-opquser-ssh-access">set up opquser ssh access</a>.</p>
<p>Second, invoke <code>meteor npm install</code> to verify that you have installed the latest versions of all libraries.</p>
<p>Third, invoke <code>meteor npm run test-all</code> to verify that the test cases pass.</p>
<p>Fourth, invoke <code>meteor npm run start</code> and then go to <a href="http://localhost:3000">http://localhost:3000</a> to verify that the system runs without problems.</p>
<h3><a class="anchor" aria-hidden="true" id="build-the-production-bundle"></a><a href="#build-the-production-bundle" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Build the production bundle</h3>
<p>In general, you will build the production bundle from the master branch of OPQView.</p>
<p>In your development environment, be sure you are in the master branch, then change directories into the <code>opq/view/app/</code> directory.</p>
<p>Now invoke <code>meteor npm run build</code>:</p>
<pre><code class="hljs"><span class="hljs-meta">$</span><span class="bash"> meteor npm run build</span>
<span class="hljs-meta">
&gt;</span><span class="bash"> opqview@ build /Users/philipjohnson/github/openpowerquality/opq/view/app</span>
<span class="hljs-meta">&gt;</span><span class="bash"> meteor build ../deploy --architecture os.linux.x86_64</span>
<span class="hljs-meta">
Node#</span><span class="bash">moveTo was deprecated. Use Container<span class="hljs-comment">#append.</span></span>
</code></pre>
<p>The contents of the <code>opq/view/deploy/</code> directory should now contain the following files:</p>
<ul>
<li>app.tar.gz: The file you just built containing the production version of the app (approximately 45 MB).</li>
<li>deploy-run.sh:  A script for running the deployment on the server.</li>
<li>deploy-transfer.sh: A script for copying the appropriate files to the server.</li>
</ul>
<p>Note that *.gz files in the deploy directory are gitignored.</p>
<h3><a class="anchor" aria-hidden="true" id="copy-deployment-files-to-the-server"></a><a href="#copy-deployment-files-to-the-server" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Copy deployment files to the server</h3>
<p>To copy deployment files to the server, cd to the opq/view/deploy directory, and invoke the <code>deploy-transfer.sh</code> script. This script creates a new directory whose name is the current timestamp, copies app.tar.gz, deploy-run.sh, and settings.development.json into it, then gzips that directory and secure copies it to emilia.</p>
<p>Here is what the invocation of this command should look like:</p>
<pre><code class="hljs">./deploy-transfer.sh 
<span class="hljs-addition">++ date +%Y%m%d_%H%M%S</span>
<span class="hljs-addition">+ timestamp=20180408_083036</span>
<span class="hljs-addition">+ mkdir 20180408_083036</span>
<span class="hljs-addition">+ cp app.tar.gz 20180408_083036</span>
<span class="hljs-addition">+ cp deploy-run.sh 20180408_083036</span>
<span class="hljs-addition">+ cp ../config/settings.development.json 20180408_083036</span>
<span class="hljs-addition">+ cd 20180408_083036</span>
<span class="hljs-addition">+ tar xf app.tar.gz</span>
<span class="hljs-addition">+ rm app.tar.gz</span>
<span class="hljs-addition">+ cd ..</span>
<span class="hljs-addition">+ tar czf 20180408_083036.tar.gz 20180408_083036</span>
<span class="hljs-addition">+ rm -rf 20180408_083036</span>
<span class="hljs-addition">+ scp -P 29862 20180408_083036.tar.gz opquser@emilia.ics.hawaii.edu:view</span>
20180408_083036.tar.gz                                                                                                100%   43MB   1.5MB/s   00:29    
<span class="hljs-addition">+ set +x</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="server-side-deployment-tasks"></a><a href="#server-side-deployment-tasks" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Server-side deployment tasks</h2>
<p>Now ssh to the server to do the remainder of the deployment:</p>
<pre><code class="hljs">ssh -<span class="hljs-selector-tag">p</span> <span class="hljs-number">29862</span> opquser@emilia<span class="hljs-selector-class">.ics</span><span class="hljs-selector-class">.hawaii</span><span class="hljs-selector-class">.edu</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="unpack-tar-file-with-latest-release"></a><a href="#unpack-tar-file-with-latest-release" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Unpack tar file with latest release</h3>
<p>Change directories into the view/ subdirectory, and list the files:</p>
<pre><code class="hljs">$ cd view
$ ls -la
ls -la
total 43572
drwxr-xr-x <span class="hljs-number"> 3 </span>opquser opquser    <span class="hljs-number"> 4096 </span>Apr <span class="hljs-number"> 8 </span>08:55 .
drwxr-xr-x<span class="hljs-number"> 10 </span>opquser opquser    <span class="hljs-number"> 4096 </span>Apr <span class="hljs-number"> 8 </span>08:50 ..
-rw-r--r-- <span class="hljs-number"> 1 </span>opquser opquser<span class="hljs-number"> 44601734 </span>Apr <span class="hljs-number"> 8 </span>08:55 20180408_085449.tar.gz
</code></pre>
<p>You should see one (or more) timestamped tar.gz files (and potentially directories). The most recent timestamped tar.gz file is the one you just copied over.  Expand it into a directory as follows:</p>
<pre><code class="hljs">$ tar xf <span class="hljs-number">20180408</span>_085449<span class="hljs-selector-class">.tar</span><span class="hljs-selector-class">.gz</span>
</code></pre>
<p>The cd into that directory, and list the contents:</p>
<pre><code class="hljs">$ cd 20180408_085449/
opquser@emilia:~/view/20180408_085449$ ls -la
total 24
drwxr-xr-x<span class="hljs-number"> 3 </span>opquser opquser<span class="hljs-number"> 4096 </span>Apr <span class="hljs-number"> 8 </span>08:56 .
drwxr-xr-x<span class="hljs-number"> 3 </span>opquser opquser<span class="hljs-number"> 4096 </span>Apr <span class="hljs-number"> 8 </span>08:55 ..
drwxr-xr-x<span class="hljs-number"> 4 </span>opquser opquser<span class="hljs-number"> 4096 </span>Apr <span class="hljs-number"> 8 </span>08:55 bundle
-rwxr-xr-x<span class="hljs-number"> 1 </span>opquser opquser <span class="hljs-number"> 322 </span>Apr <span class="hljs-number"> 8 </span>08:54 deploy-run.sh
-rw-r--r--<span class="hljs-number"> 1 </span>opquser opquser<span class="hljs-number"> 2279 </span>Apr <span class="hljs-number"> 8 </span>08:54 settings.development.json
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="kill-the-current-opqview-processes"></a><a href="#kill-the-current-opqview-processes" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Kill the current OPQView processes</h3>
<p>Find the PID of the two currently running OPQView processes this way:</p>
<pre><code class="hljs">$ ps -ef | grep <span class="hljs-keyword">node</span>
<span class="hljs-title">opquser</span>   <span class="hljs-number">2048</span>     <span class="hljs-number">1</span>  <span class="hljs-number">0</span> <span class="hljs-number">16</span>:<span class="hljs-number">21</span> ?        <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> /home/opquser/.meteor/packages/meteor-tool/.<span class="hljs-number">1.6</span>.<span class="hljs-number">1</span>_1.c76v6p.io9tw++os.linux.x86_64+web.browser+web.cordova/mt-os.linux.x86_64/dev_bundle/bin/<span class="hljs-keyword">node</span> <span class="hljs-title">--expose-gc</span> /home/opquser/.meteor/packages/meteor-tool/.<span class="hljs-number">1.6</span>.<span class="hljs-number">1</span>_1.c76v6p.io9tw++os.linux.x86_64+web.browser+web.cordova/mt-os.linux.x86_64/tools/index.js <span class="hljs-keyword">node</span> <span class="hljs-title">bundle</span>/main
opquser   <span class="hljs-number">2069</span>  <span class="hljs-number">2048</span>  <span class="hljs-number">0</span> <span class="hljs-number">16</span>:<span class="hljs-number">21</span> ?        <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">10</span> /home/opquser/.meteor/packages/meteor-tool/.<span class="hljs-number">1.6</span>.<span class="hljs-number">1</span>_1.c76v6p.io9tw++os.linux.x86_64+web.browser+web.cordova/mt-os.linux.x86_64/dev_bundle/bin/<span class="hljs-keyword">node</span> <span class="hljs-title">bundle</span>/main
opquser   <span class="hljs-number">4791</span>  <span class="hljs-number">4609</span>  <span class="hljs-number">0</span> <span class="hljs-number">16</span>:<span class="hljs-number">40</span> pts/<span class="hljs-number">3</span>    <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> grep <span class="hljs-keyword">node</span>
<span class="hljs-title"></span></code></pre>
<p>In this case, the PIDs are 2048 and 2069. Kill those processes with the following commands:</p>
<pre><code class="hljs"><span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">kill</span> -9 2048</span>
<span class="hljs-meta">$</span><span class="bash"> <span class="hljs-built_in">kill</span> -9 2069</span>
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="verify-that-the-server-is-running-the-correct-version-of-node"></a><a href="#verify-that-the-server-is-running-the-correct-version-of-node" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Verify that the server is running the correct version of node</h3>
<p>The file <code>bundle/.node_version.txt</code> indicates the required version of node. Print it with the following command:</p>
<pre><code class="hljs">$ more bundle/<span class="hljs-selector-class">.node_version</span><span class="hljs-selector-class">.txt</span> 
v8.<span class="hljs-number">11.1</span>
</code></pre>
<p>Now check that the currently installed version of node matches the required version:</p>
<pre><code class="hljs">$ <span class="hljs-keyword">node</span> <span class="hljs-title">--version</span>
v8.<span class="hljs-number">11.1</span>
</code></pre>
<p>If these don't match, then update node to the appropriate version before proceeding.</p>
<h3><a class="anchor" aria-hidden="true" id="run-the-new-version-of-opqview"></a><a href="#run-the-new-version-of-opqview" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Run the new version of OPQView</h3>
<p>To run the new version of OPQView, invoke the deploy-run.sh script:</p>
<pre><code class="hljs">$ ./deploy-run.sh 
Make sure node version is v8<span class="hljs-number">.11</span><span class="hljs-number">.1</span>

&gt; fibers@<span class="hljs-number">2.0</span><span class="hljs-number">.0</span> install <span class="hljs-regexp">/home/</span>opquser<span class="hljs-regexp">/view/</span><span class="hljs-number">20180408</span>_085449<span class="hljs-regexp">/bundle/</span>programs<span class="hljs-regexp">/server/</span>node_modules/fibers
&gt; node build.js || nodejs build.js

`linux-x64<span class="hljs-number">-57</span>` exists; testing
Binary is fine; exiting

&gt; meteor-dev-bundle@ install <span class="hljs-regexp">/home/</span>opquser<span class="hljs-regexp">/view/</span><span class="hljs-number">20180408</span>_085449<span class="hljs-regexp">/bundle/</span>programs/server
&gt; node npm-rebuild.js


&gt; bcrypt@<span class="hljs-number">1.0</span><span class="hljs-number">.3</span> install <span class="hljs-regexp">/home/</span>opquser<span class="hljs-regexp">/view/</span><span class="hljs-number">20180408</span>_085449<span class="hljs-regexp">/bundle/</span>programs<span class="hljs-regexp">/server/</span>npm<span class="hljs-regexp">/node_modules/</span>bcrypt
&gt; node-pre-gyp install --fallback-to-build

[bcrypt] <span class="hljs-string">Success:</span> <span class="hljs-string">"/home/opquser/view/20180408_085449/bundle/programs/server/npm/node_modules/bcrypt/lib/binding/bcrypt_lib.node"</span> is installed via remote
<span class="hljs-meta">@babel</span><span class="hljs-regexp">/runtime@7.0.0-beta.44 /</span>home<span class="hljs-regexp">/opquser/</span>view<span class="hljs-regexp">/20180408_085449/</span>bundle<span class="hljs-regexp">/programs/</span>server<span class="hljs-regexp">/npm/</span>node_modules<span class="hljs-regexp">/@babel/</span>runtime
  :
  (lots of lines deleted)
  :
{
  <span class="hljs-string">"npm"</span>: <span class="hljs-string">"5.6.0"</span>,
  <span class="hljs-string">"ares"</span>: <span class="hljs-string">"1.10.1-DEV"</span>,
  <span class="hljs-string">"cldr"</span>: <span class="hljs-string">"32.0"</span>,
  <span class="hljs-string">"http_parser"</span>: <span class="hljs-string">"2.8.0"</span>,
  <span class="hljs-string">"icu"</span>: <span class="hljs-string">"60.1"</span>,
  <span class="hljs-string">"modules"</span>: <span class="hljs-string">"57"</span>,
  <span class="hljs-string">"nghttp2"</span>: <span class="hljs-string">"1.25.0"</span>,
  <span class="hljs-string">"node"</span>: <span class="hljs-string">"8.11.1"</span>,
  <span class="hljs-string">"openssl"</span>: <span class="hljs-string">"1.0.2o"</span>,
  <span class="hljs-string">"tz"</span>: <span class="hljs-string">"2017c"</span>,
  <span class="hljs-string">"unicode"</span>: <span class="hljs-string">"10.0"</span>,
  <span class="hljs-string">"uv"</span>: <span class="hljs-string">"1.19.1"</span>,
  <span class="hljs-string">"v8"</span>: <span class="hljs-string">"6.2.414.50"</span>,
  <span class="hljs-string">"zlib"</span>: <span class="hljs-string">"1.2.11"</span>
}
added <span class="hljs-number">136</span> packages <span class="hljs-keyword">in</span> <span class="hljs-number">9.609</span>s
$
</code></pre>
<p>This script brings up OPQView in the background (so that you can exit this terminal session), and sends all output to the file logfile.txt. To check that the system came up normally, you can print out the contents of the logfile, which should look similar to this:</p>
<pre><code class="hljs">$ more logfile.txt 
Starting SyncedCron <span class="hljs-keyword">to</span> update<span class="hljs-built_in"> System </span>Stats every 10 seconds.
Initializing 4<span class="hljs-built_in"> user </span>profiles.
Initializing 5 OPQ boxes.
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="verify-that-the-new-opqview-appears-in-your-browser"></a><a href="#verify-that-the-new-opqview-appears-in-your-browser" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Verify that the new OPQView appears in your browser</h2>
<p>As a final check, retrieve OPQView for example: <a href="http://emilia.ics.hawaii.edu">http://emilia.ics.hawaii.edu</a>. You might want to check that whatever recent features you developed are appearing in this system. That verifies that you deployed the intended version.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="deploy-makai.html">← Deployment: Makai</a><a class="docs-next button" href="deploy-health.html">Deployment: Health →</a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#developer-system-deployment-tasks">Developer system deployment tasks</a><ul class="toc-headings"><li><a href="#build-the-production-bundle">Build the production bundle</a></li><li><a href="#copy-deployment-files-to-the-server">Copy deployment files to the server</a></li></ul></li><li><a href="#server-side-deployment-tasks">Server-side deployment tasks</a><ul class="toc-headings"><li><a href="#unpack-tar-file-with-latest-release">Unpack tar file with latest release</a></li><li><a href="#kill-the-current-opqview-processes">Kill the current OPQView processes</a></li><li><a href="#verify-that-the-server-is-running-the-correct-version-of-node">Verify that the server is running the correct version of node</a></li><li><a href="#run-the-new-version-of-opqview">Run the new version of OPQView</a></li></ul></li><li><a href="#verify-that-the-new-opqview-appears-in-your-browser">Verify that the new OPQView appears in your browser</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/opqlogo_white.png" alt="Open Power Quality" width="66" height="58"/></a><div><h5>Documentation Quick Links</h5><a href="/docs/intro-opq.html">Overview</a><a href="/docs/userguide-hardware.html">OPQ Box User Guide</a><a href="/docs/userguide-software.html">OPQ View User Guide</a><a href="/docs/other-agile-power-monitoring.html">Agile Power Monitoring for UH</a><a href="/docs/other-roadmap.html">Roadmap</a></div><div><h5>Community</h5><a href="https://openpowerquality.slack.com/" target="_blank" rel="noreferrer noopener">Slack</a><a href="https://twitter.com/opquality" target="_blank" rel="noreferrer noopener">Twitter</a><a href="/blog">News</a><a href="http://emilia.ics.hawaii.edu">Emilia (public OPQ View)</a><a href="/contact-us.html">Contact Us</a></div><div><h5>Development</h5><a href="https://github.com/openpowerquality">GitHub</a><a href="https://github.com/openpowerquality/opq/projects/1">Project Board</a><a href="/team.html">Developer Team</a><a href="/docs/opportunities.html">Opportunities</a></div></section><p style="text-align:center;color:#e9faff">Open Power Quality is sponsored by:<br/><a style="text-align:center;color:#e9faff" href="http://csdl.ics.hawaii.edu">Collaborative Software Development Laboratory, University of Hawaii</a><br/><a style="text-align:center;color:#e9faff" href="http://www.ics.hawaii.edu">Department of Information and Computer Sciences, University of Hawaii</a><br/><a style="text-align:center;color:#e9faff" href="http://ee.hawaii.edu">Department of Electrical Engineering, University of Hawaii</a><br/></p></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                
                apiKey: '9bf16cc78135dbeeb3826894ebbbb2ee',
                indexName: 'openpowerquality',
                inputSelector: '#search_input_react'
              });
            </script></body></html>